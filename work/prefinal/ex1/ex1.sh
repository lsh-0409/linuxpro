#!/bin/bash

# 1. 인자 확인
if [ $# -ne 1 ]; then
    echo "Usage: $0 <url>"
    exit 1
fi

# 입력받은 URL을 변수에 저장
# 예: ftp://worldcup2022.korea.com:456/game?match=16
url="$1"

echo "url : $url"

# -----------------------------------------------------------
# 2. 프로토콜 (Protocol) 추출
# 패턴: '://' 뒤에 오는 모든 것을 뒤에서부터 길게(%%) 삭제
# -----------------------------------------------------------
protocol=${url%%://*}
echo "protocol : $protocol"

# [남은 문자열 갱신] 프로토콜 부분(:// 포함)을 앞에서 제거
# 패턴: '://' 까지 앞에서부터 짧게(#) 삭제 (여기선 *://)
remain=${url#*://}

# -----------------------------------------------------------
# 3. 호스트 (Host) 추출
# 남은 문자열: worldcup2022.korea.com:456/game?match=16
# 패턴: ':' 뒤에 오는 모든 것을 뒤에서부터 길게(%%) 삭제?
# 주의: 여기서는 ':'가 구분자이므로, 첫 번째 ':' 뒤를 날려야 함 (%%)
# -----------------------------------------------------------
host=${remain%%:*}
echo "host : $host"

# [남은 문자열 갱신] 호스트 부분(: 포함)을 앞에서 제거
# 패턴: ':' 까지 앞에서부터 짧게(#) 삭제
remain=${remain#*:}

# -----------------------------------------------------------
# 4. 포트 (Port) 추출
# 남은 문자열: 456/game?match=16
# 패턴: '/' 뒤를 뒤에서부터 길게(%%) 삭제
# -----------------------------------------------------------
port=${remain%%/*}
echo "port : $port"

# [남은 문자열 갱신] 포트 부분(/ 포함)을 앞에서 제거
remain=${remain#*/}

# -----------------------------------------------------------
# 5. 앱 (App) 추출
# 남은 문자열: game?match=16
# 패턴: '?' 뒤를 뒤에서부터 길게(%%) 삭제
# 주의: ?는 와일드카드이므로 '\?'로 이스케이프 해야 함
# -----------------------------------------------------------
app=${remain%%\?*}
echo "app : $app"

# -----------------------------------------------------------
# 6. 쿼리 (Query) 추출
# 패턴: '?' 앞부분을 앞에서부터 짧게(#) 삭제
# -----------------------------------------------------------
query=${remain#*\?}
echo "query : $query"
